<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery.terminal@2.x.x/js/jquery.terminal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery.terminal@2.x.x/css/jquery.terminal.min.css" />
    <title>Lambda Inerpreter</title>
</head>
<body>
    <h1>Lambda interpreter</h1>
    <p>LAMBDA CALCULUS (also written as Î»-calculus) is a system in mathematical logic 
        for expressing computation using function abstraction and application. The system captures 
        the notion of computation; it is computationally equivalent to the Turing Machine and can therefore
         model any Turing machine program.

        The system was defined in the 1930s by Alonzo Church in his paper 
        "An Unsolvable Problem of Elementary Number Theory" as part of his research in the foundations of mathematics.</p>
    <div id="terminal"></div>
    <div id="turing">
            <form id="turingform">
            <label for="head">Provide head state :</label><br>
            <input type="text"id="head" required /><br>
            <label for="tape">Provide initial tape :</label><br>
            <input type="text"id="tape" required /><br>
            <label for="ruleset">Provide a ruleset(JSON format) :</label><br>
            <textarea  id="ruleset"></textarea><br>
            <button type="submit">Initalize Machine</button>
        </form>
        <div class="state-display" id="stateDisplay"></div>
        <div class="tape-container" id="tapeContainer"></div>
        <div class="controls">
            <button>Run/Pause</button>
            <button>step</button>
            <button>Reset</button>
        </div>
    </div>
    <script>
        //console.log("AM I EXECUTED ")
        $(function() {
             $('#terminal').terminal(function(command,term){
                 const encodedExpression = encodeURIComponent(command)
		 fetch(`/parse_expression?expression=${encodedExpression}`)
		     .then(response => response.text())
		     .then(data => this.echo(data))
		     .catch(error => this.echo(error))

             },{
                greetings : 'Lambda Calculus Interpreter',
                
             });
      });
      document.getElementById("turingform").addEventListener('submit',async (e)=>{
        e.preventDefault();
        const head_state =document.getElementById("head").value 
      const tape_state=document.getElementById("tape").value 
        ruleset_state=document.getElementById("ruleset").value 
      ruleset_state=ruleset_state.replace(/[\n\r]/g, ' ').trim();
      //console.log(head_state)
      //console.log(tape_state)
      //console.log(ruleset_state)
      const payload={
           "head":head_state,
           "tape":tape_state,
           "rule_set":ruleset_state
      }
      console.log(payload)
      const response=await fetch('/machine',{
        method: "POST",
        headers:{
            "Content-Type" :'application/json'
        },
        body:JSON.stringify(payload)
      })
      const data = await response.text()
      console.log(data)
      })
      
    </script>
</body>
</html>
